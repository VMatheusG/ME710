---
title: "R Notebook"
output:
  html_document:
    df_print: paged
  pdf_document: default
---




#O Modelo

Considere:

$s_i$é o par de de coordenadas de cada estação.

$Z(s_i)=Z_i$  o valor média de chuva observado em cada estação.

$n$ é o numero total de estações amostradas.

O objetivo da krigagem é predizer o valor da variavel Z num ponto não observado.

seja $\{\textbf{Z}(\textbf{s}):\textbf{s} \in D\}$ um campo gausiano aleatório, $D$ é o conjunto dos pares de coordenadas que perternce 
a região de languedoc roussilon.

para conseguirmos fazer inferência, iremos assumir isotropia, estacionaridade da média,covariâcia e variograma::

$$
E[Z(s_i)] = \mu \quad\forall  \; s_ì\\
Cov(Z(s_i),Z(s_j)) = Cov(Z(s_i),Z(s_i +h))=C(h)\quad \forall\ i,j\\
2\gamma(h) = E[(Z(s_i)-Z(s_i + h))^2] = 2[C(0)-C(h)]
$$


ou seja a média, a covariâcia e o variograma são independentes da posição e podem ser estimados por:

$$
\hat\mu = \sum_{i=1}^{n}\frac{Z(s_i)}{n}\\
\hat{C}(h)=\frac{1}{|N(\textbf{h})|}\sum_{|N(\textbf{h})|}(Z(s_i)-\hat{\mu})(Z(s_j)-\hat{\mu})\\
2 \hat\gamma(\textbf{h}) = \frac{1}{|N(\textbf{h})|}\sum_{N(\textbf{h})}[Z(s_i)-Z(s_j)]^2
$$
onde

$$
N(\textbf{h})=\{(s_i,s_j):s_i-s_j=\textbf{h}, \ i=1,...,n,\ j = 1,...,n\}\quad \textbf{h} \in R^2
$$

O estimador de krigagem $\hat Z(s_0)$ devera é obtido por minimizar



$$
min_\lambda \ E([Z(s_o)-p(\textbf{Z},s_0)]^2) = \\ 
min_\lambda \{ \ Var(Z(s_o)-p(\textbf{Z},s_0))+(\mu-\sum_{i=1}^{n}\lambda_i\, Z(s_i))^2\}
$$

onde: $p(\textbf{Z},s_0)=\sum_{i=1}^{n}\lambda_i\, Z(s_i)$

que nos leva ao melhor preditor linear não viesado:

$$
\hat Z(s_0)= E[Z(s_0)|Z_1,...,Z_n]=\boldsymbol\mu+\Gamma_0\Gamma^{-1}(\textbf{Z}- 
\boldsymbol{\mu})
$$

onde:

$$
\Gamma=\begin{bmatrix}
  \gamma(0) & \gamma(s_2-s_1) & \cdots & \gamma(s_n-s_1)) \\
  \gamma(s_1-s_2) & \gamma(0) & \cdots & \gamma(s_n-s_2)) \\
  \vdots & \ddots & \ddots & \vdots\\
  \gamma(s_1-s_n) & \cdots & \cdots & \gamma(0)
\end{bmatrix}
$$

$$
\Gamma_0^{\ t} = \begin{bmatrix}
\gamma(s_0-s_1) \\
\gamma(s_0-s_2) \\
\vdots \\
\gamma(s_0-s_n)
\end{bmatrix}
$$



O variograma amostral, foi ajustado a um modelo teórico de classe exponencial.

